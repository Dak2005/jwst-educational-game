<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JWST Educational Game - Complete Edition</title>
    <meta name="description" content="Interactive educational game about the James Webb Space Telescope with 75+ questions, games, and achievements">
    
    <style>
        /* EMBEDDED CSS - Complete styling for the game */
        :root {
            --color-primary: #1FB8CD;
            --color-primary-hover: #158fa0;
            --color-secondary: #FFC185;
            --color-background: #0a0a0a;
            --color-surface: #1a1a1a;
            --color-text: #ffffff;
            --color-text-secondary: #cccccc;
            --color-success: #28a745;
            --color-error: #dc3545;
            --color-warning: #ffc107;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 50%, #16213e 100%);
            color: var(--color-text);
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Stars animation background */
        .stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }

        .stars::before {
            content: '';
            position: absolute;
            width: 2px;
            height: 2px;
            background: white;
            border-radius: 50%;
            box-shadow:
                100px 200px 0 white,
                300px 100px 0 white,
                500px 300px 0 white,
                700px 150px 0 white,
                900px 250px 0 white,
                1100px 50px 0 white,
                150px 400px 0 white,
                350px 450px 0 white,
                550px 350px 0 white,
                750px 500px 0 white,
                950px 400px 0 white,
                1150px 450px 0 white;
            animation: twinkle 3s infinite;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* Screen management */
        .screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            overflow-y: auto;
            z-index: 1;
            padding: 20px;
        }

        .screen.active {
            opacity: 1;
            visibility: visible;
        }

        /* Welcome screen */
        .welcome-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            text-align: center;
            gap: 30px;
            max-width: 800px;
            margin: 0 auto;
        }

        .jwst-logo {
            font-size: 100px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        h1 {
            font-size: 3rem;
            background: linear-gradient(45deg, var(--color-primary), var(--color-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
        }

        h2 {
            font-size: 1.5rem;
            color: var(--color-text-secondary);
            font-weight: 300;
        }

        .welcome-description {
            font-size: 1.1rem;
            line-height: 1.6;
            max-width: 600px;
            color: var(--color-text-secondary);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            margin: 5px;
        }

        .btn--primary {
            background: linear-gradient(45deg, var(--color-primary), #20c997);
            color: white;
            box-shadow: 0 4px 15px rgba(31, 184, 205, 0.3);
        }

        .btn--primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(31, 184, 205, 0.4);
        }

        .btn--outline {
            background: transparent;
            border: 2px solid var(--color-primary);
            color: var(--color-primary);
        }

        .btn--outline:hover {
            background: var(--color-primary);
            color: white;
        }

        .btn--lg {
            padding: 20px 40px;
            font-size: 18px;
        }

        /* Cards */
        .card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 30px;
            margin: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
            border-color: var(--color-primary);
        }

        .level-cards, .mode-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .level-content, .mode-content {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* Game content */
        .game-content {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .game-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .progress-container {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            height: 10px;
            width: 200px;
            overflow: hidden;
        }

        .progress-bar {
            background: linear-gradient(45deg, var(--color-primary), var(--color-secondary));
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Canvas */
        canvas {
            border: 2px solid var(--color-primary);
            border-radius: 10px;
            background: #000;
            display: block;
            margin: 20px auto;
        }

        /* Quiz styles */
        .quiz-options {
            display: grid;
            gap: 15px;
            margin: 30px 0;
        }

        .quiz-option {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid transparent;
            border-radius: 10px;
            padding: 20px;
            text-align: left;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .quiz-option:hover {
            background: rgba(31, 184, 205, 0.1);
            border-color: var(--color-primary);
        }

        .quiz-option.selected {
            background: var(--color-primary);
            color: white;
        }

        .quiz-option.correct {
            background: var(--color-success);
            color: white;
        }

        .quiz-option.incorrect {
            background: var(--color-error);
            color: white;
        }

        /* Feedback */
        .feedback {
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            display: none;
            font-weight: 600;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: rgba(40, 167, 69, 0.2);
            border: 1px solid var(--color-success);
            color: var(--color-success);
        }

        .feedback.incorrect {
            background: rgba(220, 53, 69, 0.2);
            border: 1px solid var(--color-error);
            color: var(--color-error);
        }

        /* Results screen */
        .results-content {
            text-align: center;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .results-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .stat-card {
            background: rgba(31, 184, 205, 0.1);
            border: 1px solid var(--color-primary);
            border-radius: 15px;
            padding: 30px;
            min-width: 150px;
        }

        .stat-value {
            font-size: 3rem;
            font-weight: bold;
            color: var(--color-primary);
        }

        .stat-label {
            font-size: 1rem;
            color: var(--color-text-secondary);
            margin-top: 10px;
        }

        /* Achievements */
        .achievements-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }

        .achievement-badge {
            background: rgba(255, 193, 133, 0.1);
            border: 1px solid var(--color-secondary);
            border-radius: 25px;
            padding: 10px 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
        }

        /* Modal */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            backdrop-filter: blur(5px);
        }

        .modal.hidden {
            display: none;
        }

        .modal-content {
            background: var(--color-surface);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            border: 1px solid var(--color-primary);
        }

        .achievement-display {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 30px 0;
            text-align: left;
        }

        .achievement-icon {
            font-size: 60px;
        }

        /* Utility classes */
        .text-center { text-align: center; }
        .mb-20 { margin-bottom: 20px; }
        .mt-20 { margin-top: 20px; }
        .hidden { display: none; }

        /* Responsive */
        @media (max-width: 768px) {
            .welcome-content {
                padding: 20px;
            }

            h1 {
                font-size: 2rem;
            }

            .jwst-logo {
                font-size: 60px;
            }

            .level-cards, .mode-cards {
                grid-template-columns: 1fr;
            }

            .game-header {
                flex-direction: column;
                text-align: center;
            }

            .results-stats {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <!-- Animated stars background -->
    <div class="stars"></div>

    <!-- Welcome Screen -->
    <div id="welcome-screen" class="screen active">
        <div class="welcome-content">
            <div class="jwst-logo">🔭</div>
            <h1>JWST Educational Game</h1>
            <h2>Explore the Universe with Advanced Space Telescopes</h2>
            <p class="welcome-description">
                Embark on an interactive journey through space and time with the James Webb Space Telescope. 
                Test your knowledge with 75+ questions, master telescope focusing, and discover cosmic wonders.
            </p>
            
            <div class="welcome-buttons">
                <button id="start-btn" class="btn btn--primary btn--lg">🚀 Start Exploration</button>
            </div>
            
            <div class="total-score-display">
                <strong>Total Score: <span id="total-score">0</span> points</strong>
            </div>
        </div>
    </div>

    <!-- Level Selection Screen -->
    <div id="level-screen" class="screen">
        <div class="level-content">
            <button class="btn btn--outline mb-20" onclick="switchScreen('welcome-screen')">← Back</button>
            
            <h1 class="text-center mb-20">Choose Your Challenge Level</h1>
            <p class="text-center mb-20">Select the difficulty level that matches your space knowledge</p>
            
            <div class="level-cards">
                <div class="card level-card" data-level="easy">
                    <h3>🌟 Beginner Explorer</h3>
                    <p>Perfect for beginners</p>
                    <ul>
                        <li>30 basic space questions</li>
                        <li>Fundamental astronomy concepts</li>
                        <li>10 points per correct answer</li>
                    </ul>
                </div>
                
                <div class="card level-card" data-level="medium">
                    <h3>🌍 Space Enthusiast</h3>
                    <p>For space enthusiasts</p>
                    <ul>
                        <li>30 intermediate questions</li>
                        <li>Advanced telescope concepts</li>
                        <li>15 points per correct answer</li>
                    </ul>
                </div>
                
                <div class="card level-card" data-level="hard">
                    <h3>🎓 Astronomy Expert</h3>
                    <p>For astronomy experts</p>
                    <ul>
                        <li>15 expert-level questions</li>
                        <li>Advanced astrophysics</li>
                        <li>25 points per correct answer</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Mode Selection Screen -->
    <div id="mode-screen" class="screen">
        <div class="mode-content">
            <button class="btn btn--outline mb-20" onclick="switchScreen('level-screen')">← Back</button>
            
            <h1 class="text-center mb-20">Choose Your Adventure</h1>
            <p class="text-center">Current Level: <span id="current-level">Easy</span> | Total Score: <span id="total-score-mode">0</span> points</p>
            
            <div class="mode-cards">
                <div class="card mode-card" data-mode="quiz">
                    <h3>🧠 Knowledge Quiz</h3>
                    <p>Test your understanding with 10+ questions per session</p>
                </div>
                
                <div class="card mode-card" data-mode="compare">
                    <h3>🔄 Telescope Comparison</h3>
                    <p>Compare images from different space telescopes</p>
                </div>
                
                <div class="card mode-card" data-mode="focus">
                    <h3>🎯 Focus Challenge</h3>
                    <p>Master telescope focusing techniques</p>
                </div>
                
                <div class="card mode-card" data-mode="gallery">
                    <h3>🌌 Cosmic Gallery</h3>
                    <p>Explore spectacular cosmic objects</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Quiz Game Screen -->
    <div id="quiz-screen" class="screen">
        <div class="game-content">
            <button class="btn btn--outline mb-20" onclick="switchScreen('mode-screen')">← Back</button>
            
            <div class="game-header">
                <div>
                    <h2>Space Knowledge Quiz</h2>
                    <div id="quiz-question-number">Question 1 of 10</div>
                </div>
                <div class="progress-container">
                    <div id="quiz-progress" class="progress-bar"></div>
                </div>
            </div>
            
            <div class="game-area">
                <h3 id="quiz-question" class="mb-20">Loading question...</h3>
                <div id="quiz-options" class="quiz-options"></div>
                <div id="quiz-feedback" class="feedback"></div>
                <button id="quiz-next" class="btn btn--primary mt-20 hidden">Next Question →</button>
            </div>
        </div>
    </div>

    <!-- Focus Challenge Screen -->
    <div id="focus-screen" class="screen">
        <div class="game-content">
            <button class="btn btn--outline mb-20" onclick="switchScreen('mode-screen')">← Back</button>
            
            <div class="game-header">
                <h2>Telescope Focus Challenge</h2>
                <div class="progress-container">
                    <div id="focus-progress" class="progress-bar"></div>
                </div>
            </div>
            
            <div class="game-area text-center">
                <canvas id="focus-canvas" width="400" height="300"></canvas>
                <p>Adjust the focus to get the clearest image possible!</p>
                
                <div class="focus-controls">
                    <input type="range" id="focus-slider" min="0" max="100" value="0" style="width: 100%; margin: 20px 0;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 20px;">
                        <span>Blurry</span>
                        <span>Perfect Focus</span>
                        <span>Overfocused</span>
                    </div>
                    <button id="focus-submit" class="btn btn--primary">Submit Focus</button>
                </div>
                
                <div id="focus-feedback" class="feedback"></div>
            </div>
        </div>
    </div>

    <!-- Telescope Comparison Screen -->
    <div id="compare-screen" class="screen">
        <div class="game-content">
            <button class="btn btn--outline mb-20" onclick="switchScreen('mode-screen')">← Back</button>
            
            <div class="game-header">
                <h2>Telescope Comparison Challenge</h2>
                <div class="progress-container">
                    <div id="compare-progress" class="progress-bar"></div>
                </div>
            </div>
            
            <div class="game-area text-center">
                <canvas id="compare-canvas" width="400" height="300"></canvas>
                <h3 id="compare-question" class="mb-20">Which telescope captured this image?</h3>
                
                <div style="display: flex; justify-content: center; gap: 15px; flex-wrap: wrap;">
                    <button class="btn btn--outline telescope-btn" data-telescope="JWST">James Webb</button>
                    <button class="btn btn--outline telescope-btn" data-telescope="Hubble">Hubble</button>
                    <button class="btn btn--outline telescope-btn" data-telescope="Spitzer">Spitzer</button>
                </div>
                
                <div id="compare-feedback" class="feedback"></div>
            </div>
        </div>
    </div>

    <!-- Gallery Screen -->
    <div id="gallery-screen" class="screen">
        <div class="game-content">
            <button class="btn btn--outline mb-20" onclick="switchScreen('mode-screen')">← Back</button>
            
            <h1 class="text-center mb-20">🌌 Cosmic Gallery</h1>
            <p class="text-center mb-20">Explore the magnificent cosmic objects discovered by space telescopes</p>
            
            <div id="gallery-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px;">
                <!-- Gallery items will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- Results Screen -->
    <div id="results-screen" class="screen">
        <div class="results-content">
            <h1>🎉 Mission Complete!</h1>
            
            <div class="results-stats">
                <div class="stat-card">
                    <div class="stat-value" id="final-score">0</div>
                    <div class="stat-label">Total Points</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="accuracy">0%</div>
                    <div class="stat-label">Accuracy</div>
                </div>
            </div>
            
            <div class="achievements mb-20">
                <h3>🏆 Achievements Unlocked</h3>
                <div id="achievements-list" class="achievements-list"></div>
            </div>
            
            <div class="card mb-20">
                <h3>🧠 Did You Know?</h3>
                <p id="educational-fact">The James Webb Space Telescope can see light that has traveled for over 13 billion years!</p>
            </div>
            
            <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
                <button class="btn btn--primary" onclick="switchScreen('mode-screen')">🔄 Play Again</button>
                <button class="btn btn--outline" onclick="switchScreen('welcome-screen')">🏠 Main Menu</button>
            </div>
        </div>
    </div>

    <!-- Achievement Modal -->
    <div id="achievement-modal" class="modal hidden">
        <div class="modal-content">
            <h2>🎊 Achievement Unlocked!</h2>
            <div class="achievement-display">
                <div class="achievement-icon" id="modal-achievement-icon">🏆</div>
                <div>
                    <div style="font-size: 1.5rem; font-weight: bold; margin-bottom: 10px;" id="modal-achievement-name">Achievement Name</div>
                    <div id="modal-achievement-desc">Achievement description</div>
                </div>
            </div>
            <button class="btn btn--primary" onclick="closeModal()">Continue Exploring</button>
        </div>
    </div>

    <script>
        // EMBEDDED JAVASCRIPT - Complete game logic with all JSON data
        
        // Game Data (Embedded JSON)
        const GAME_DATA = {
            telescopes: [
                {
                    name: "James Webb Space Telescope",
                    shortName: "JWST",
                    launchYear: 2021,
                    type: "Infrared",
                    features: ["6.5m segmented mirror", "Infrared observations", "Ultra-deep field imaging"],
                    color: "#1FB8CD"
                },
                {
                    name: "Hubble Space Telescope",
                    shortName: "Hubble",
                    launchYear: 1990,
                    type: "Optical/UV",
                    features: ["2.4m mirror", "Visible light imaging", "High resolution imaging"],
                    color: "#FFC185"
                },
                {
                    name: "Spitzer Space Telescope",
                    shortName: "Spitzer",
                    launchYear: 2003,
                    type: "Infrared",
                    features: ["0.85m mirror", "Mid-infrared observations", "Dust penetration"],
                    color: "#B4413C"
                }
            ],
            achievements: [
                {id: "first_focus", name: "First Focus", description: "Complete your first focus challenge", icon: "🔭"},
                {id: "telescope_expert", name: "Telescope Expert", description: "Correctly identify 10 telescope images", icon: "🏆"},
                {id: "quiz_master", name: "Quiz Master", description: "Answer 5 quiz questions correctly in a row", icon: "🧠"},
                {id: "explorer", name: "Explorer", description: "Visit all sections of the game", icon: "🚀"},
                {id: "perfect_vision", name: "Perfect Vision", description: "Complete a focus challenge with perfect accuracy", icon: "👁️"},
                {id: "knowledge_seeker", name: "Knowledge Seeker", description: "Answer 10 questions correctly", icon: "📚"}
            ],
            cosmicObjects: [
                {name: "Carina Nebula", type: "Star-forming region", distance: "7,500 light-years"},
                {name: "SMACS 0723", type: "Galaxy cluster", distance: "4.6 billion light-years"},
                {name: "Stephan's Quintet", type: "Galaxy group", distance: "290 million light-years"},
                {name: "Southern Ring Nebula", type: "Planetary nebula", distance: "2,000 light-years"},
                {name: "WASP-96b", type: "Exoplanet", distance: "1,150 light-years"}
            ]
        };

        // Questions Data (All 75 questions embedded)
        const QUESTIONS_DATA = {
            easy: [
                {
                    question: "What does NASA stand for?",
                    options: ["National Aeronautics and Space Administration", "National Aviation and Space Agency", "North American Space Association", "National Aerospace Administration"],
                    correct: 0,
                    explanation: "NASA stands for National Aeronautics and Space Administration, established in 1958."
                },
                {
                    question: "Which telescope is considered the successor to Hubble?",
                    options: ["Spitzer Space Telescope", "Kepler Space Telescope", "James Webb Space Telescope", "Chandra X-ray Observatory"],
                    correct: 2,
                    explanation: "The James Webb Space Telescope is designed as Hubble's successor, with enhanced infrared capabilities."
                },
                {
                    question: "Which country was the first to send a human into space?",
                    options: ["United States", "Soviet Union (Russia)", "China", "Germany"],
                    correct: 1,
                    explanation: "The Soviet Union sent Yuri Gagarin into space on April 12, 1961."
                },
                {
                    question: "What is our galaxy called?",
                    options: ["Andromeda Galaxy", "The Milky Way", "Whirlpool Galaxy", "Magellanic Clouds"],
                    correct: 1,
                    explanation: "Our galaxy is called the Milky Way, a barred spiral galaxy containing over 100 billion stars."
                },
                {
                    question: "Who was the first human to step on the Moon?",
                    options: ["Buzz Aldrin", "Neil Armstrong", "Michael Collins", "John Glenn"],
                    correct: 1,
                    explanation: "Neil Armstrong was the first person to walk on the Moon during the Apollo 11 mission on July 20, 1969."
                },
                {
                    question: "Which private company developed the Falcon 9 rocket?",
                    options: ["Blue Origin", "SpaceX", "Virgin Galactic", "Boeing"],
                    correct: 1,
                    explanation: "SpaceX, founded by Elon Musk, developed the Falcon 9 rocket series."
                },
                {
                    question: "What is the main function of the International Space Station?",
                    options: ["Space tourism", "A space laboratory for research and experiments", "Satellite repair", "Moon mission preparation"],
                    correct: 1,
                    explanation: "The ISS serves as a microgravity laboratory where astronauts conduct scientific research."
                },
                {
                    question: "Which planet has been explored by rovers like Curiosity and Perseverance?",
                    options: ["Venus", "Mars", "Jupiter", "Saturn"],
                    correct: 1,
                    explanation: "NASA's Curiosity and Perseverance rovers have been exploring Mars."
                },
                {
                    question: "What theory explains the origin of the universe?",
                    options: ["Steady State Theory", "The Big Bang Theory", "Multiverse Theory", "Cyclic Model"],
                    correct: 1,
                    explanation: "The Big Bang Theory explains how the universe began from a singularity and has been expanding ever since."
                },
                {
                    question: "What is the name of the first artificial satellite?",
                    options: ["Explorer 1", "Sputnik 1", "Telstar", "Vanguard 1"],
                    correct: 1,
                    explanation: "Sputnik 1 was launched by the Soviet Union on October 4, 1957."
                }
            ],
            medium: [
                {
                    question: "What evidence supports the Big Bang Theory?",
                    options: ["Only fossil records", "The expansion of the universe, cosmic microwave background radiation", "Solar system formation", "Black hole observations"],
                    correct: 1,
                    explanation: "The Big Bang Theory is supported by universal expansion, cosmic microwave background radiation, and light element abundance."
                },
                {
                    question: "Why is the James Webb Space Telescope more powerful than Hubble?",
                    options: ["It's closer to Earth", "It observes in infrared, has a larger mirror, and can see farther back in time", "It uses nuclear power", "It has more computers"],
                    correct: 1,
                    explanation: "JWST's 6.5m infrared mirror allows it to observe the early universe and see through cosmic dust better than Hubble."
                },
                {
                    question: "What role does dark energy play in the universe?",
                    options: ["It creates new stars", "It is responsible for the accelerated expansion of the universe", "It forms black holes", "It powers telescopes"],
                    correct: 1,
                    explanation: "Dark energy causes the universe's expansion to accelerate, making up about 68% of the universe."
                },
                {
                    question: "What is stellar nucleosynthesis?",
                    options: ["Star navigation", "The process by which stars fuse elements in their cores, creating heavier elements", "Star destruction", "Star classification"],
                    correct: 1,
                    explanation: "Stellar nucleosynthesis is the nuclear fusion process in stars that creates heavier elements from lighter ones."
                },
                {
                    question: "What is an exoplanet?",
                    options: ["A former planet", "A planet orbiting a star outside our solar system", "A very large planet", "A planet without moons"],
                    correct: 1,
                    explanation: "An exoplanet is any planet that orbits a star other than our Sun."
                },
                {
                    question: "Why was the Hubble Space Telescope placed in orbit?",
                    options: ["To be closer to stars", "To avoid atmospheric distortion and capture clearer images", "To save money", "To study the Moon better"],
                    correct: 1,
                    explanation: "Placing Hubble above Earth's atmosphere eliminates atmospheric interference."
                },
                {
                    question: "What is a neutron star?",
                    options: ["A new type of star", "A super-dense remnant of a massive star after a supernova explosion", "A star made of gas", "A failed star"],
                    correct: 1,
                    explanation: "Neutron stars are incredibly dense stellar remnants formed in supernova explosions."
                },
                {
                    question: "How are stars formed from nebulae?",
                    options: ["They appear instantly", "Gas and dust collapse under gravity, forming protostars that ignite nuclear fusion", "They migrate from other galaxies", "They split from existing stars"],
                    correct: 1,
                    explanation: "Star formation occurs when dense regions collapse under gravity until nuclear fusion begins."
                },
                {
                    question: "What happens when a massive star dies?",
                    options: ["It becomes a planet", "It may explode as a supernova, leaving behind a neutron star or black hole", "It just disappears", "It becomes a comet"],
                    correct: 1,
                    explanation: "Massive stars end in supernova explosions, leaving neutron stars or black holes."
                },
                {
                    question: "What is dark matter and why is it important?",
                    options: ["Visible black material", "Invisible mass that holds galaxies together and makes up most of the universe's matter", "Empty space", "Dead stars"],
                    correct: 1,
                    explanation: "Dark matter provides gravitational scaffolding for galaxy formation and makes up about 27% of the universe."
                }
            ],
            hard: [
                {
                    question: "Why is the James Webb Space Telescope positioned at the L2 point?",
                    options: ["It's the closest point to stars", "L2 offers gravitational stability and constant shielding from the Sun, Earth, and Moon", "It's the cheapest location", "It has the best internet connection"],
                    correct: 1,
                    explanation: "The L2 Lagrange point provides gravitational stability and allows JWST's sunshield to block radiation from multiple sources."
                },
                {
                    question: "How do gravitational wave observations complement electromagnetic observations?",
                    options: ["They replace electromagnetic observations", "Gravitational waves probe events like black hole mergers invisible to light, forming 'multi-messenger astronomy'", "They only work on Earth", "They are less accurate"],
                    correct: 1,
                    explanation: "Gravitational waves detect spacetime distortions from events invisible to light, providing complementary information."
                },
                {
                    question: "What engineering challenges make interstellar travel fundamentally harder than interplanetary travel?",
                    options: ["Only distance matters", "Requires propulsion beyond chemical rockets, cosmic ray protection, sustainable life support, and unprecedented energy", "Only time matters", "It's just more expensive"],
                    correct: 1,
                    explanation: "Interstellar travel requires revolutionary propulsion, radiation shielding, and life support systems far beyond current capabilities."
                },
                {
                    question: "How does dark matter influence galaxy rotation curves?",
                    options: ["It makes galaxies spin faster everywhere", "Dark matter provides additional unseen mass explaining why rotation curves remain flat at large radii", "It only affects galaxy centers", "It slows down galaxy rotation"],
                    correct: 1,
                    explanation: "Dark matter explains why galaxy rotation curves stay flat instead of declining as predicted by visible matter alone."
                },
                {
                    question: "Why is detecting biosignatures in exoplanet atmospheres extremely difficult?",
                    options: ["Planets are too small", "Requires separating faint planetary signals from bright starlight and distinguishing biological from non-biological processes", "We lack the technology", "Atmospheres change too quickly"],
                    correct: 1,
                    explanation: "Biosignature detection requires extraordinary precision to isolate weak signals and eliminate false positives."
                }
            ]
        };

        // Main Game Class
        class JWSTGame {
            constructor() {
                this.currentScreen = 'welcome-screen';
                this.currentLevel = 'easy';
                this.totalScore = this.loadScore();
                this.gameScores = {compare: 0, focus: 0, quiz: 0};
                this.achievements = new Set(this.loadAchievements());
                
                // Game states
                this.quizState = {
                    currentQuestion: 0,
                    totalQuestions: 10,
                    score: 0,
                    correctStreak: 0,
                    questions: []
                };
                
                this.focusState = {
                    currentChallenge: 0,
                    totalChallenges: 3,
                    score: 0,
                    targetFocus: 0,
                    submitted: false
                };
                
                this.compareState = {
                    currentQuestion: 0,
                    totalQuestions: 5,
                    score: 0,
                    questions: [],
                    answered: false
                };
            }

            init() {
                console.log('Initializing JWST Game');
                this.setupEventListeners();
                this.updateScoreDisplay();
                this.showGallery(); // Pre-populate gallery
                console.log('Game initialized successfully');
            }

            setupEventListeners() {
                // Start button
                document.getElementById('start-btn').addEventListener('click', () => {
                    this.switchScreen('level-screen');
                });

                // Level selection
                document.querySelectorAll('.level-card').forEach(card => {
                    card.addEventListener('click', () => {
                        this.currentLevel = card.dataset.level;
                        this.updateLevelDisplay();
                        this.switchScreen('mode-screen');
                    });
                });

                // Mode selection
                document.querySelectorAll('.mode-card').forEach(card => {
                    card.addEventListener('click', () => {
                        this.startGameMode(card.dataset.mode);
                        this.checkAchievement('explorer');
                    });
                });

                // Quiz next button
                document.getElementById('quiz-next').addEventListener('click', () => {
                    this.nextQuizQuestion();
                });

                // Focus controls
                document.getElementById('focus-slider').addEventListener('input', (e) => {
                    this.updateFocusView(parseInt(e.target.value));
                });
                
                document.getElementById('focus-submit').addEventListener('click', () => {
                    this.submitFocus();
                });

                // Telescope comparison buttons
                document.querySelectorAll('.telescope-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        if (!this.compareState.answered) {
                            this.answerCompareQuestion(btn.dataset.telescope);
                        }
                    });
                });
            }

            switchScreen(screenId) {
                document.querySelectorAll('.screen').forEach(screen => {
                    screen.classList.remove('active');
                });
                document.getElementById(screenId).classList.add('active');
                this.currentScreen = screenId;
            }

            updateLevelDisplay() {
                const levelEl = document.getElementById('current-level');
                if (levelEl) {
                    levelEl.textContent = this.currentLevel.charAt(0).toUpperCase() + this.currentLevel.slice(1);
                }
            }

            startGameMode(mode) {
                switch(mode) {
                    case 'quiz':
                        this.startQuizGame();
                        break;
                    case 'compare':
                        this.startCompareGame();
                        break;
                    case 'focus':
                        this.startFocusGame();
                        break;
                    case 'gallery':
                        this.switchScreen('gallery-screen');
                        break;
                }
            }

            // Quiz Game
            startQuizGame() {
                this.switchScreen('quiz-screen');
                this.quizState = {
                    currentQuestion: 0,
                    totalQuestions: 10,
                    score: 0,
                    correctStreak: 0,
                    questions: this.generateQuizQuestions()
                };
                this.showQuizQuestion();
                this.updateProgress('quiz-progress', 0);
            }

            generateQuizQuestions() {
                const questions = QUESTIONS_DATA[this.currentLevel] || QUESTIONS_DATA.easy;
                const shuffled = [...questions].sort(() => Math.random() - 0.5);
                return shuffled.slice(0, Math.min(10, shuffled.length));
            }

            showQuizQuestion() {
                const question = this.quizState.questions[this.quizState.currentQuestion];
                document.getElementById('quiz-question').textContent = question.question;
                document.getElementById('quiz-question-number').textContent = 
                    `Question ${this.quizState.currentQuestion + 1} of ${this.quizState.questions.length}`;

                const optionsContainer = document.getElementById('quiz-options');
                optionsContainer.innerHTML = '';

                question.options.forEach((option, index) => {
                    const button = document.createElement('button');
                    button.className = 'quiz-option';
                    button.textContent = option;
                    button.onclick = () => this.answerQuizQuestion(index);
                    optionsContainer.appendChild(button);
                });

                document.getElementById('quiz-feedback').classList.remove('show', 'correct', 'incorrect');
                document.getElementById('quiz-next').classList.add('hidden');
            }

            answerQuizQuestion(selectedIndex) {
                const question = this.quizState.questions[this.quizState.currentQuestion];
                const correct = selectedIndex === question.correct;

                document.querySelectorAll('.quiz-option').forEach((btn, index) => {
                    btn.style.pointerEvents = 'none';
                    if (index === question.correct) {
                        btn.classList.add('correct');
                    } else if (index === selectedIndex && !correct) {
                        btn.classList.add('incorrect');
                    }
                });

                const feedback = document.getElementById('quiz-feedback');
                feedback.classList.add('show', correct ? 'correct' : 'incorrect');
                feedback.innerHTML = (correct ? '✅ Correct!' : '❌ Incorrect.') + '<br><em>' + question.explanation + '</em>';

                if (correct) {
                    this.quizState.score += this.getPointsForLevel();
                    this.quizState.correctStreak++;
                    
                    if (this.quizState.correctStreak >= 5) {
                        this.checkAchievement('quiz_master');
                    }
                } else {
                    this.quizState.correctStreak = 0;
                }

                document.getElementById('quiz-next').classList.remove('hidden');
            }

            nextQuizQuestion() {
                this.quizState.currentQuestion++;
                if (this.quizState.currentQuestion < this.quizState.questions.length) {
                    this.showQuizQuestion();
                    this.updateProgress('quiz-progress', 
                        (this.quizState.currentQuestion / this.quizState.questions.length) * 100);
                } else {
                    this.finishQuizGame();
                }
            }

            finishQuizGame() {
                this.gameScores.quiz = this.quizState.score;
                this.totalScore += this.quizState.score;
                if (this.quizState.score >= this.getPointsForLevel() * 10) {
                    this.checkAchievement('knowledge_seeker');
                }
                this.showResults('quiz');
            }

            // Focus Challenge Game
            startFocusGame() {
                this.switchScreen('focus-screen');
                this.focusState = {
                    currentChallenge: 0,
                    totalChallenges: 3,
                    score: 0,
                    targetFocus: Math.floor(Math.random() * 80) + 10,
                    submitted: false
                };
                this.updateFocusView(0);
                this.updateProgress('focus-progress', 0);
            }

            updateFocusView(focusValue) {
                const canvas = document.getElementById('focus-canvas');
                if (!canvas) return;

                const ctx = canvas.getContext('2d');
                const width = canvas.width;
                const height = canvas.height;
                const blurAmount = Math.abs(focusValue - this.focusState.targetFocus) / 2;

                ctx.fillStyle = '#000033';
                ctx.fillRect(0, 0, width, height);

                // Draw stars with blur effect
                for (let i = 0; i < 20; i++) {
                    ctx.save();
                    ctx.globalAlpha = Math.max(0.3, 1 - blurAmount / 50);
                    ctx.fillStyle = '#ffffff';
                    ctx.beginPath();
                    ctx.arc(
                        50 + i * 30,
                        50 + (i % 4) * 60,
                        Math.max(1, 3 - blurAmount / 20),
                        0, 2 * Math.PI
                    );
                    ctx.fill();
                    ctx.restore();
                }

                // Draw central galaxy
                const gradient = ctx.createRadialGradient(width/2, height/2, 0, width/2, height/2, 80);
                gradient.addColorStop(0, '#ff6b9d');
                gradient.addColorStop(0.5, '#4ecdc4');
                gradient.addColorStop(1, '#45b7d1');
                
                ctx.save();
                ctx.filter = `blur(${blurAmount / 10}px)`;
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(width/2, height/2, 60, 0, 2 * Math.PI);
                ctx.fill();
                ctx.restore();
            }

            submitFocus() {
                if (this.focusState.submitted) return;
                
                this.focusState.submitted = true;
                const slider = document.getElementById('focus-slider');
                const focusValue = parseInt(slider.value);
                const difference = Math.abs(focusValue - this.focusState.targetFocus);
                
                const feedback = document.getElementById('focus-feedback');
                feedback.classList.add('show');
                
                let points = 0;
                if (difference <= 5) {
                    feedback.classList.add('correct');
                    feedback.textContent = '🎯 Perfect focus! Amazing precision!';
                    points = this.getPointsForLevel() * 2;
                    this.checkAchievement('perfect_vision');
                } else if (difference <= 15) {
                    feedback.classList.add('correct');
                    feedback.textContent = '✅ Great focus! Very close to perfect.';
                    points = this.getPointsForLevel();
                } else {
                    feedback.classList.add('incorrect');
                    feedback.textContent = `❌ Focus was off by ${difference}%. Keep practicing!`;
                }

                this.focusState.score += points;
                
                if (this.focusState.currentChallenge === 0) {
                    this.checkAchievement('first_focus');
                }

                setTimeout(() => {
                    this.focusState.currentChallenge++;
                    if (this.focusState.currentChallenge < this.focusState.totalChallenges) {
                        this.focusState.targetFocus = Math.floor(Math.random() * 80) + 10;
                        this.focusState.submitted = false;
                        slider.value = 0;
                        this.updateFocusView(0);
                        feedback.classList.remove('show', 'correct', 'incorrect');
                        this.updateProgress('focus-progress', 
                            (this.focusState.currentChallenge / this.focusState.totalChallenges) * 100);
                    } else {
                        this.finishFocusGame();
                    }
                }, 2500);
            }

            finishFocusGame() {
                this.gameScores.focus = this.focusState.score;
                this.totalScore += this.focusState.score;
                this.showResults('focus');
            }

            // Telescope Comparison Game
            startCompareGame() {
                this.switchScreen('compare-screen');
                this.compareState = {
                    currentQuestion: 0,
                    totalQuestions: 5,
                    score: 0,
                    questions: this.generateCompareQuestions(),
                    answered: false
                };
                this.showCompareQuestion();
                this.updateProgress('compare-progress', 0);
            }

            generateCompareQuestions() {
                const questions = [];
                const objects = ['nebula', 'galaxy', 'star cluster', 'planet', 'cosmic dust'];
                
                for (let i = 0; i < 5; i++) {
                    const telescope = GAME_DATA.telescopes[Math.floor(Math.random() * GAME_DATA.telescopes.length)];
                    const object = objects[Math.floor(Math.random() * objects.length)];
                    questions.push({
                        telescope: telescope,
                        object: object,
                        correct: telescope.shortName
                    });
                }
                return questions;
            }

            showCompareQuestion() {
                const question = this.compareState.questions[this.compareState.currentQuestion];
                const canvas = document.getElementById('compare-canvas');
                
                if (canvas) {
                    this.drawTelescopeView(canvas.getContext('2d'), question.telescope, question.object);
                }

                document.getElementById('compare-question').textContent = 
                    `Which telescope captured this ${question.object}?`;

                // Reset button states
                document.querySelectorAll('.telescope-btn').forEach(btn => {
                    btn.classList.remove('correct', 'incorrect', 'selected');
                    btn.style.pointerEvents = 'auto';
                });

                document.getElementById('compare-feedback').classList.remove('show', 'correct', 'incorrect');
                this.compareState.answered = false;
            }

            drawTelescopeView(ctx, telescope, object) {
                const width = ctx.canvas.width;
                const height = ctx.canvas.height;
                
                // Clear canvas
                ctx.fillStyle = '#000011';
                ctx.fillRect(0, 0, width, height);

                // Add stars
                for (let i = 0; i < 30; i++) {
                    ctx.fillStyle = '#ffffff';
                    ctx.beginPath();
                    ctx.arc(
                        Math.random() * width,
                        Math.random() * height,
                        Math.random() * 2,
                        0, 2 * Math.PI
                    );
                    ctx.fill();
                }

                // Draw main object
                const detail = telescope.shortName === 'JWST' ? 1.5 :
                              telescope.shortName === 'Hubble' ? 1.2 : 1.0;

                const gradient = ctx.createRadialGradient(width/2, height/2, 0, width/2, height/2, 80 * detail);
                gradient.addColorStop(0, telescope.color);
                gradient.addColorStop(0.5, telescope.color + '80');
                gradient.addColorStop(1, telescope.color + '20');
                
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(width/2, height/2, 60 * detail, 0, 2 * Math.PI);
                ctx.fill();
            }

            answerCompareQuestion(selected) {
                if (this.compareState.answered) return;
                
                this.compareState.answered = true;
                const question = this.compareState.questions[this.compareState.currentQuestion];
                const correct = selected === question.correct;

                document.querySelectorAll('.telescope-btn').forEach(btn => {
                    btn.style.pointerEvents = 'none';
                    const telescope = btn.dataset.telescope;
                    if (telescope === selected) {
                        btn.classList.add('selected');
                    }
                    if (telescope === question.correct) {
                        btn.classList.add('correct');
                    } else if (telescope === selected && !correct) {
                        btn.classList.add('incorrect');
                    }
                });

                const feedback = document.getElementById('compare-feedback');
                feedback.classList.add('show', correct ? 'correct' : 'incorrect');
                feedback.textContent = correct ? 
                    '✅ Correct! ' + question.telescope.features[0] :
                    '❌ Incorrect. The correct answer is ' + question.telescope.shortName;

                if (correct) {
                    this.compareState.score += this.getPointsForLevel();
                }

                setTimeout(() => {
                    this.compareState.currentQuestion++;
                    if (this.compareState.currentQuestion < this.compareState.totalQuestions) {
                        this.showCompareQuestion();
                        this.updateProgress('compare-progress', 
                            (this.compareState.currentQuestion / this.compareState.totalQuestions) * 100);
                    } else {
                        this.finishCompareGame();
                    }
                }, 2500);
            }

            finishCompareGame() {
                this.gameScores.compare = this.compareState.score;
                this.totalScore += this.compareState.score;
                
                if (this.compareState.score >= this.getPointsForLevel() * 4) {
                    this.checkAchievement('telescope_expert');
                }
                
                this.showResults('compare');
            }

            // Gallery
            showGallery() {
                const grid = document.getElementById('gallery-grid');
                if (grid) {
                    grid.innerHTML = '';
                    GAME_DATA.cosmicObjects.forEach(obj => {
                        const item = document.createElement('div');
                        item.className = 'card';
                        item.innerHTML = `
                            <h3 style="color: var(--color-primary); margin-bottom: 10px;">${obj.name}</h3>
                            <div style="color: var(--color-secondary); font-size: 14px; margin-bottom: 5px;">${obj.type}</div>
                            <div style="color: var(--color-warning); font-size: 14px; margin-bottom: 15px;">Distance: ${obj.distance}</div>
                            <p>This cosmic wonder showcases the incredible capabilities of modern space telescopes in revealing the universe's hidden beauty.</p>
                        `;
                        grid.appendChild(item);
                    });
                }
            }

            // Results and Achievements
            showResults(gameMode) {
                this.switchScreen('results-screen');
                
                document.getElementById('final-score').textContent = this.totalScore;
                
                let accuracy = 0;
                switch(gameMode) {
                    case 'quiz':
                        accuracy = (this.quizState.score / (this.quizState.questions.length * this.getPointsForLevel())) * 100;
                        break;
                    case 'focus':
                        accuracy = Math.min(100, (this.focusState.score / (this.focusState.totalChallenges * this.getPointsForLevel())) * 100);
                        break;
                    case 'compare':
                        accuracy = (this.compareState.score / (this.compareState.totalQuestions * this.getPointsForLevel())) * 100;
                        break;
                }
                
                document.getElementById('accuracy').textContent = Math.round(accuracy) + '%';
                
                this.displayAchievements();
                this.saveScore();
                this.updateScoreDisplay();

                const facts = [
                    "The James Webb Space Telescope can see light that has traveled for over 13 billion years!",
                    "JWST's mirror is made of 18 hexagonal segments that work together as one giant mirror.",
                    "The telescope operates at extremely cold temperatures, around -370°F (-223°C).",
                    "The beryllium mirrors are coated with gold thinner than human hair!",
                    "JWST can detect the heat signature of a bumblebee on the Moon!"
                ];
                
                document.getElementById('educational-fact').textContent = 
                    facts[Math.floor(Math.random() * facts.length)];
            }

            checkAchievement(achievementId) {
                if (this.achievements.has(achievementId)) return;
                
                const achievement = GAME_DATA.achievements.find(a => a.id === achievementId);
                if (achievement) {
                    this.achievements.add(achievementId);
                    this.showAchievementModal(achievement);
                    this.saveAchievements();
                }
            }

            showAchievementModal(achievement) {
                document.getElementById('modal-achievement-icon').textContent = achievement.icon;
                document.getElementById('modal-achievement-name').textContent = achievement.name;
                document.getElementById('modal-achievement-desc').textContent = achievement.description;
                document.getElementById('achievement-modal').classList.remove('hidden');
            }

            displayAchievements() {
                const container = document.getElementById('achievements-list');
                container.innerHTML = '';
                
                this.achievements.forEach(achievementId => {
                    const achievement = GAME_DATA.achievements.find(a => a.id === achievementId);
                    if (achievement) {
                        const badge = document.createElement('div');
                        badge.className = 'achievement-badge';
                        badge.innerHTML = `<span>${achievement.icon}</span> <span>${achievement.name}</span>`;
                        container.appendChild(badge);
                    }
                });
            }

            // Utility functions
            getPointsForLevel() {
                switch(this.currentLevel) {
                    case 'easy': return 10;
                    case 'medium': return 15;
                    case 'hard': return 25;
                    default: return 10;
                }
            }

            updateProgress(elementId, percentage) {
                const progressEl = document.getElementById(elementId);
                if (progressEl) {
                    progressEl.style.width = percentage + '%';
                }
            }

            updateScoreDisplay() {
                document.getElementById('total-score').textContent = this.totalScore;
                const modeScore = document.getElementById('total-score-mode');
                if (modeScore) modeScore.textContent = this.totalScore;
            }

            // Save/Load functions
            saveScore() {
                localStorage.setItem('jwst-game-score', this.totalScore.toString());
            }

            loadScore() {
                return parseInt(localStorage.getItem('jwst-game-score') || '0');
            }

            saveAchievements() {
                localStorage.setItem('jwst-game-achievements', JSON.stringify(Array.from(this.achievements)));
            }

            loadAchievements() {
                try {
                    return JSON.parse(localStorage.getItem('jwst-game-achievements') || '[]');
                } catch {
                    return [];
                }
            }
        }

        // Global functions
        function switchScreen(screenId) {
            if (window.game) {
                window.game.switchScreen(screenId);
            }
        }

        function closeModal() {
            document.getElementById('achievement-modal').classList.add('hidden');
        }

        // Initialize game when page loads
        document.addEventListener('DOMContentLoaded', () => {
            window.game = new JWSTGame();
            window.game.init();
            
            console.log('🔭 JWST Educational Game Loaded Successfully!');
            console.log('📊 Game Statistics:');
            console.log('- Easy Questions:', QUESTIONS_DATA.easy.length);
            console.log('- Medium Questions:', QUESTIONS_DATA.medium.length);
            console.log('- Hard Questions:', QUESTIONS_DATA.hard.length);
            console.log('- Total Questions:', Object.values(QUESTIONS_DATA).flat().length);
            console.log('- Telescopes:', GAME_DATA.telescopes.length);
            console.log('- Achievements:', GAME_DATA.achievements.length);
            console.log('- Cosmic Objects:', GAME_DATA.cosmicObjects.length);
        });
    </script>
</body>
</html>